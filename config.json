{
  "log_file": "/var/log/auth.log",
  "time_window_minutes": 5,
  "whitelist_ips": ["127.0.0.1"],

  "telegram": {
    "enabled": true,
    "token": "YOUR_BOT_TOKEN_HERE",
    "chat_id": "YOUR_CHAT_ID_HERE",
    "notify_level": "MEDIUM",
    "include_realtime": true,
    "include_batch": true,
    "rate_limit_seconds": 60
  },

  "rules": {

    "ssh_failed_login": {
      "enabled": true,
      "threshold": 3,
      "severity": "HIGH",
      "weight": 3,
      "pattern": "Failed password for.*from ([0-9.]+)",
      "mitre": {
        "technique": "T1110",
        "name": "Brute Force"
      }
    },

    "ssh_invalid_user": {
      "enabled": true,
      "threshold": 3,
      "severity": "HIGH",
      "weight": 3,
      "pattern": "Invalid user .* from ([0-9.]+)",
      "mitre": {
        "technique": "T1110",
        "name": "Credential Access"
      }
    },

    "ping_flood": {
      "enabled": true,
      "threshold": 10,
      "severity": "MEDIUM",
      "weight": 2,
      "pattern": "ICMP echo request.*from ([0-9.]+)",
      "mitre": {
        "technique": "T1498",
        "name": "Network Denial of Service"
      }
    },

    "nmap_scan": {
      "enabled": true,
      "threshold": 5,
      "severity": "HIGH",
      "weight": 4,
      "pattern": "Nmap scan report for ([0-9.]+)",
      "mitre": {
        "technique": "T1046",
        "name": "Network Service Discovery"
      }
    },

    "port_scan_syslog": {
      "enabled": true,
      "threshold": 10,
      "severity": "HIGH",
      "weight": 4,
      "pattern": "connection attempt.*from ([0-9.]+)",
      "mitre": {
        "technique": "T1046",
        "name": "Network Scanning"
      }
    },

    "http_scan": {
      "enabled": true,
      "threshold": 15,
      "severity": "MEDIUM",
      "weight": 2,
      "pattern": "GET .* HTTP/1\\.[01]\" 404 .* ([0-9.]+)",
      "mitre": {
        "technique": "T1595",
        "name": "Active Scanning"
      }
    },

    "sql_injection": {
      "enabled": true,
      "threshold": 3,
      "severity": "CRITICAL",
      "weight": 5,
      "pattern": "(union select|or 1=1|information_schema|--).* ([0-9.]+)",
      "mitre": {
        "technique": "T1190",
        "name": "Exploit Public-Facing Application"
      }
    },

    "ftp_bruteforce": {
      "enabled": true,
      "threshold": 3,
      "severity": "HIGH",
      "weight": 3,
      "pattern": "FTP login failed.*from ([0-9.]+)",
      "mitre": {
        "technique": "T1110",
        "name": "Brute Force"
      }
    },

    "webshell_upload": {
      "enabled": true,
      "threshold": 1,
      "severity": "CRITICAL",
      "weight": 5,
      "pattern": "(\\.php|\\.jsp|\\.asp) upload.*from ([0-9.]+)",
      "mitre": {
        "technique": "T1505",
        "name": "Server Software Component"
      }
    }

  }
}

